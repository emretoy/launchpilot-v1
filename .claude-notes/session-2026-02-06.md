# Oturum: 6 Şubat 2026

## Yapılan İş: Blog Konu Tarama Sistemi

### Yeni Dosyalar
1. **`src/lib/blog-topic-scanner.ts`** — 5 kaynaklı tarama motoru
   - Serper Autocomplete (5 sorgu)
   - Serper Search + PAA + Related (4 sorgu)
   - Serper Reddit (3 sorgu)
   - Serper Competitor (3 sorgu)
   - Google Trends via Serper (1 sorgu)
   - Gemini sentez → 50-100 yapılandırılmış blog konusu
   - Kesik JSON repair fonksiyonu (maxOutputTokens: 32768)

2. **`src/app/api/blog-topics/route.ts`** — POST (tarama) + GET (yükleme)
   - Batch insert (20'lik gruplar), hatalı batch'lerde tek tek retry
   - Service role ile RLS bypass

3. **`src/app/api/blog-topics/[id]/route.ts`** — PATCH (status güncelle)

4. **`src/components/blog-topic-panel.tsx`** — Sol panel UI
   - Ülke/Dil seçiciler, filtreler (kaynak, zorluk, kategori, metin arama)
   - Kategoriye göre gruplanmış konu kartları
   - Kaynak ikonları + alaka skoru + zorluk badge

### Düzenlenen Dosyalar
1. **`src/lib/types.ts`** — BlogTopic, BlogTopicScanRequest, BlogTopicScanResult eklendi
2. **`src/app/blog-yaz/page.tsx`** — İki panelli layout, sessionStorage cache + Supabase persist
3. **`src/components/blog-generator.tsx`** — `initialTopic` prop + useEffect (minimal)

### Supabase
- `blog_topics` tablosu oluşturuldu (RLS aktif)
- Status workflow: suggested → planned → writing → published → rejected

### Çözülen Sorunlar
- Gemini JSON kesik yanıt → `repairAndParseJSON()` ile kurtarma
- `google-trends-api` npm paketi yok → Serper tabanlı fallback
- Sayfadan çıkınca konular siliniyor → sessionStorage cache eklendi
- Toplu insert hata → 20'lik batch + tek tek retry

## Kalan İşler / Yarın Devam
- [ ] Test: gerçek tarama yapıp sonuçları doğrula
- [ ] Supabase insert loglarını kontrol et (hatalı satırlar var mı?)
- [ ] Mobil responsive (şu an sol panel sabit 380px)
- [ ] "Yeniden Tara" yapınca eski konuları temizleme/merge stratejisi
- [ ] Blog takvimi UI (planned_date ile takvim görünümü — gelecek faz)
